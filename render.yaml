services:
  - type: web
    name: fortuna-lottery-api
    env: node
    region: frankfurt
    plan: free
    rootDir: .  # –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞
    buildCommand: |
      echo "üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Å–±–æ—Ä–∫—É Fortuna Lottery API..."
      npm install
      echo "üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
      # –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ start-with-migrate.js –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
    startCommand: node server/start-with-migrate.js
    healthCheckPath: /api/health
    healthCheckTimeout: 30
    healthCheckInterval: 60
    autoDeploy: true
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000
      - key: TELEGRAM_BOT_TOKEN
        sync: false  # –ë—É–¥–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤—Ä—É—á–Ω—É—é –≤ Dashboard
      - key: DATABASE_URL
        sync: false  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤–Ω–µ—à–Ω—é—é –ë–î Render
      - key: DRAW_SECRET
        generateValue: true  # –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
    disk:
      name: data
      mountPath: /data
      sizeGB: 1

  - type: worker
    name: fortuna-lottery-scheduler
    env: node
    region: frankfurt
    plan: free
    rootDir: .  # –¢–∞ –∂–µ –∫–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
    buildCommand: npm install
    startCommand: node server/cron-worker.js
    envVars:
      - key: NODE_ENV
        value: production
      - key: DATABASE_URL
        sync: false  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤–Ω–µ—à–Ω—é—é –ë–î Render
      - key: DRAW_SECRET
        sync: false  # –ë—É–¥–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å web-—Å–µ—Ä–≤–∏—Å–æ–º
    disk:
      name: data
      mountPath: /data
      sizeGB: 1

databases:
  - name: fortuna-database
    databaseName: fortuna_lottery
    plan: free
    region: frankfurt
    postgresMajorVersion: "15"
    # –í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø –≤–∫–ª—é—á–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ë–î
    ipAllowList:
      - source: 0.0.0.0/0
        description: "–†–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –æ—Ç–æ–≤—Å—é–¥—É"
